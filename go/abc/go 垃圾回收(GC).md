#  什么是GC

**Garbage Collection**简称为GC，是垃圾回收的意思。GC就是为了回收进程运行时不再使用的内存。但是GC会导致一个严重的问题就是会引起**STW**（stop-the-world）出现，也就是整个进程会阻塞，直到GC结束。应该尽可能的减少进程的GC时间，而且GO每两分钟就会执行一次GC操作。

经典的gc算法：**引用计数（reference counting）**、**标记-清扫（mark & sweep）**、**节点复制（Copying Garbage Collection）**，**分代收集（Generational Garbage Collection）**。



## 引用计数：

​	对每个对象维护一个引用计数，当引用该对象的对象被销毁或更新时被引用对象的引用计数自动减一，当被引用对象被创建或被赋值给其他对象时引用计数自动加一。当引用计数为0时则立即回收对象。

​	这种方法的优点是实现简单，并且内存的回收很及时。这种算法在内存比较紧张和实时性比较高的系统中使用的比较广泛，如ios cocoa框架，php，python等。简单引用计数算法也有明显的缺点：

 * 频繁更新引用计数降低了性能。一种简单的解决方法就是编译器将相邻的引用计数更新操作合并到一次更新；还有一种方法是针对频繁发生的临时变量引用不进行计数，而是在引用达到0时通过扫描堆栈确认是否还有临时对象引用而决定是否释放。等等还有很多其他方法，具体可以参考这里。
 * 循环引用问题。当对象间发生循环引用时引用链中的对象都无法得到释放。最明显的解决办法是避免产生循环引用，如cocoa引入了strong指针和weak指针两种指针类型。或者系统检测循环引用并主动打破循环链。当然这也增加了垃圾回收的复杂度。

